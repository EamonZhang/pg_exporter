#-------------------------------------------------------------#
# pg_func
# note that database with tremendous of tables may suffer from
# this query. Use sampling filter or just disable it in that case
#-------------------------------------------------------------#

pg_func:
  query: |
    SELECT CURRENT_CATALOG AS datname,
           schemaname      AS nspname,
           funcname,
           calls,
           total_time,
           self_time
    FROM pg_stat_user_functions;

  ttl: 10
  tags: []
  min_version: 090400
  skip_errors: true
  metrics:
    - datname:
        usage: LABEL
        description: database name of this relation
    - nspname:
        usage: LABEL
        description: schema name of this relation
    - funcname:
        usage: LABEL
        description: relation name of this relation
    - calls:
        usage: COUNTER
        description: how many times this function has been called
    - total_time:
        usage: COUNTER
        description: how much time spent in this function and it's child function, in ms
    - self_time:
        usage: COUNTER
        description: how much time spent in this function itself (other func not included), in ms

