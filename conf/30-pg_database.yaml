#-------------------------------------------------------------#
# pg_database
# Static database information from pg_database
#-------------------------------------------------------------#

pg_database:
  query: |
    SELECT datname,
           pg_database_size(oid)      AS size,
           age(datfrozenxid)          AS age,
           datistemplate              AS is_template,
           datallowconn               AS allow_conn,
           datconnlimit               AS conn_limit,
           datfrozenxid::TEXT::BIGINT as frozen_xid
    FROM pg_database;
  ttl: 100
  tags: [cluster]
  min_version: 100000
  max_version: 130000

  metrics:
    - datname:
        usage: LABEL
        description: database name
    - size:
        usage: GAUGE
        description: database size in bytes
    - age:
        usage: GAUGE
        description: database age calculated by age(datfrozenxid)
    - is_template:
        usage: GAUGE
        description: 1 for template db , 0 for normal db
    - allow_conn:
        usage: GAUGE
        description: 1 allow connection, 0 does not allow
    - conn_limit:
        usage: GAUGE
        description: connection limit, -1 for no limit
    - frozen_xid:
        usage: GAUGE
        description: tuple with xmin below this will always be visable (until wrap around)


